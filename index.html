<!DOCTYPE html>
<html>
<head>
    <title>Word Add-in</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script>
        let lastCursorLocation; // To save the user's last cursor location

        Office.onReady(() => {
            console.log("Add-in is ready");

            // Save the cursor location when the document gains focus
            Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged, () => {
                Word.run(async (context) => {
                    // Save the current cursor location as a range
                    lastCursorLocation = context.document.getSelection();
                    lastCursorLocation.load();
                    await context.sync();
                }).catch((error) => {
                    console.error("Error saving cursor location:", error.message);
                });
            });
        });

        function insertTextAtSavedCursor() {
            Word.run(async (context) => {
                if (!lastCursorLocation) {
                    console.error("Cursor location not saved. Insert text at the beginning.");
                    context.document.body.insertText("Hello from your Word Add-in!", Word.InsertLocation.start);
                } else {
                    // Insert text at the saved cursor location
                    lastCursorLocation.insertText("Hello from your Word Add-in!", Word.InsertLocation.replace);
                }

                // Commit the changes
                await context.sync();
                console.log("Text inserted at saved cursor location!");
            }).catch((error) => {
                console.error("Error inserting text:", error.message);
            });
        }
    </script>
</head>
<body>
    <h1>Insert Text Add-in</h1>
    <button onclick="insertTextAtSavedCursor()">Insert Text</button>
</body>
</html>
